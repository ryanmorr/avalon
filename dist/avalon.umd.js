/*! @ryanmorr/avalon v0.1.0 | https://github.com/ryanmorr/avalon */function _typeof3(a){"@babel/helpers - typeof";return _typeof3="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof3(a)}(function(a,b){"object"===("undefined"==typeof exports?"undefined":_typeof3(exports))&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a=a||self,a.avalon=b())})(this,function(){'use strict';function a(b){"@babel/helpers - typeof";return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){return f(a)||g(a,b)||j()}function f(a){if(Array.isArray(a))return a}function g(a,b){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function j(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function k(a){var b=n.get(this);return b||(b=new Map,n.set(this,b)),1<(b=X(this,b.get(a)||(b.set(a,b=function(b){for(var c,d,f=1,g="",i="",j=[0],k=function(a){1===f&&(a||(g=g.replace(/^\s*\n\s*|\s*\n\s*$/g,"")))?j.push(0,a,g):3===f&&(a||g)?(j.push(3,a,g),f=2):2===f&&"..."===g&&a?j.push(4,a,0):2===f&&g&&!a?j.push(5,0,!0,g):5<=f&&((g||!a&&5===f)&&(j.push(f,0,g,d),f=6),a&&(j.push(f,a,0,d),f=6)),g=""},m=0;m<b.length;m++){m&&(1===f&&k(),k(m));for(var n=0;n<b[m].length;n++)c=b[m][n],1===f?"<"===c?(k(),j=[j],f=3):g+=c:4===f?"--"===g&&">"===c?(f=1,g=""):g=c+g[0]:i?c===i?i="":g+=c:"\""===c||"'"===c?i=c:">"===c?(k(),f=1):f&&("="===c?(f=5,d=g,g=""):"/"===c&&(5>f||">"===b[m][n+1])?(k(),3===f&&(j=j[0]),f=j,(j=j[0]).push(2,0,f),f=0):" "===c||"\t"===c||"\n"===c||"\r"===c?(k(),f=2):g+=c),3===f&&"!--"===g&&(f=4,j=j[0])}return k(),j}(a)),b),arguments,[])).length?b:b[0]}/*! @ryanmorr/carbon v0.1.0 | https://github.com/ryanmorr/carbon */function l(b){return l="function"==typeof Symbol&&"symbol"==_typeof3(Symbol.iterator)?function(b){return _typeof3(b)}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":_typeof3(b)},l(b)}function m(b){return m="function"==typeof Symbol&&"symbol"===l(Symbol.iterator)?function(b){return l(b)}:function(b){return b&&"function"==typeof Symbol&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":l(b)},m(b)}function o(b){return p(b)||q(b)||r()}function p(d){if(Array.isArray(d)){for(var a=0,e=Array(d.length);a<d.length;a++)e[a]=d[a];return e}}function q(b){if(Symbol.iterator in Object(b)||"[object Arguments]"===Object.prototype.toString.call(b))return Array.from(b)}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function s(d){for(var a,e=0;e<d.length;)a=d[e],Array.isArray(a)?0<a.length?(a.unshift(e,1),d.splice.apply(d,a),a.splice(0,2)):d.splice(e,1):e++;return d}function u(g){var a="";if("string"==typeof g)return g;if(Array.isArray(g)&&0<g.length)for(var h,i=0,j=g.length;i<j;i++)""!==(h=u(g[i]))&&(a+=(a&&" ")+h);else for(var e in g)g[e]&&(a+=(a&&" ")+e);return a}function v(){for(var d=arguments.length,a=Array(d),b=0;b<d;b++)a[b]=arguments[b];return Object.assign.apply(Object,[{}].concat(a))}function w(b){return b.attributes&&b.attributes.key||null}function x(b){return null!=b&&"boolean"!=typeof b}function y(b,c){return b.nodeName===c.nodeName&&w(b)===w(c)}function z(b,c){return b.nodeType===c.nodeType&&(b.nodeType!==3||b.text===c.text)&&b.nodeName===c.nodeName}function A(h,a,b){for(var c={},d=a;d<=b;++d){var i=h[d],f=i&&w(i);null!=f&&(c[f]=d)}return c}function B(c){var a=m(c);return"boolean"===a?null:"string"===a||"number"===a?E(c):Array.isArray(c)?s(c).reduce(function(c,a){return x(a)&&c.push(B(a)),c},[]):c}function C(f){return 3===f.nodeType?E(f.data,f):1===f.nodeType?D(f.nodeName.toLowerCase(),Array.from(f.attributes).reduce(function(a,b){var c=b.name,d=b.value;return"style"!==c&&(a[c]=d),"key"===c&&f.removeAttribute("key"),a},{}),Array.from(f.childNodes).map(C),f):void 0}function D(e,a,b){var c=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{nodeType:1,node:c,nodeName:e,attributes:a,children:b}}function E(c){var a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null;return{nodeType:3,node:a,text:c}}function F(f){var g,h=!!(1<arguments.length&&void 0!==arguments[1])&&arguments[1];if(f.nodeType===3)g=document.createTextNode(f.text);else{var a=f.nodeName;h=h||"svg"===a,g=h?document.createElementNS("http://www.w3.org/2000/svg",a):document.createElement(a);var d=f.attributes;Object.keys(d).forEach(function(b){return G(g,b,null,d[b],h)}),f.children.forEach(function(b){return g.appendChild(F(b,h))})}return f.node=g,g}function G(h,a,i,c){var j=!!(4<arguments.length&&void 0!==arguments[4])&&arguments[4];if("key"!==a&&"children"!==a)if(j?"className"===a&&(a="class"):"class"===a&&(a="className"),("class"===a||"className"===a)&&(c=u(c)),"style"!==a)a.startsWith("on")&&("function"==typeof i||"function"==typeof c)?(a=a.slice(2).toLowerCase(),c&&h.addEventListener(a,c),i&&h.removeEventListener(a,i)):!j&&"list"!==a&&"form"!==a&&a in h?h[a]=null==c?"":c:null==c||!1===c?h.removeAttribute(a):"function"!=typeof c&&h.setAttribute(a,c);else if("string"==typeof c)h.style.cssText=c;else for(var e in v(c,i)){var f=null==c||null==c[e]?"":c[e];e.includes("-")?h.style.setProperty(e,f):h.style[e]=f}}function H(i,a,b,c){for(var d,v=0,x=a.length-1,z=a[0],B=a[x],C=0,D=b.length-1,E=b[0],G=b[D];v<=x&&C<=D;)if(!z)z=a[++v];else if(!B)B=a[--x];else if(y(z,E))I(i,z,E,c),z=a[++v],E=b[++C];else if(y(B,G))I(i,B,G,c),B=a[--x],G=b[--D];else if(y(z,G))I(i,z,G,c),i.insertBefore(z.node,B.node.nextSibling),z=a[++v],G=b[--D];else if(y(B,E))I(i,B,E,c),i.insertBefore(B.node,z.node),B=a[--x],E=b[++C];else{d||(d=A(a,v,x));var H=w(E),o=H?d[H]:null;if(null==o)i.insertBefore(F(E,c),z.node),E=b[++C];else{var p=a[o];I(i,p,E,c),a[o]=void 0,i.insertBefore(p.node,z.node),E=b[++C]}}if(v>x)for(var q=b[D+1]?b[D+1].node:null,r=C;r<=D;r++)i.insertBefore(F(b[r],c),q);else if(C>D)for(var J,K=v;K<=x;K++)J=a[K],J&&J.node&&i.removeChild(J.node);return b}function I(k,a,b){var c=!!(3<arguments.length&&void 0!==arguments[3])&&arguments[3];if(a===b)return null==a?null:a.node;if(null==a)return k.appendChild(F(b,c));var l=a.node;if(null==b)return k.removeChild(l)&&null;if(3===a.nodeType&&3===b.nodeType)a.text!==b.text&&(l.data=b.text);else if(!z(b,a)){var m=F(b,c);k.replaceChild(m,l),l=m}else{c=c||"svg"===b.nodeName;var f=document.activeElement,g=a.attributes,h=b.attributes;for(var i in v(h,g))("value"==i||"selected"===i||"checked"===i?l[i]:g[i])!==h[i]&&G(l,i,g[i],h[i],c);H(l,a.children,b.children,c),f.focus()}return b.node=l,l}function J(g,a){for(var h=arguments.length,c=Array(2<h?h-2:0),i=2;i<h;i++)c[i-2]=arguments[i];if(!a||a.nodeType||"function"==typeof a.concat){var j;c=(j=[]).concat.apply(j,[a||[]].concat(o(c))),a={}}return D(g,a||{},B(c))}function h(g,a){a=B(a);var h=g.vdom||(0<g.childNodes.length?Array.from(g.childNodes).map(C):null),i=Array.isArray(h),d=Array.isArray(a);if(g.vdom=a,i||d){h=(i?h:[h]).filter(x),a=(d?a:[a]).filter(x);var e=H(g,h,a);return 0===e.length?null:1===e.length?e[0].node:e.map(function(b){return b.node})}return I(g,h,a)}/*! @ryanmorr/schedule-render v2.0.1 | https://github.com/ryanmorr/schedule-render */function i(){for(W=null;0<t.length;)t.shift().render()}function K(c){return new Promise(function(a,b){W||(W=requestAnimationFrame(i)),t.push({render:function(){return a(c())},cancel:b})})}function L(a){return!Number.isNaN(parseFloat(a))&&isFinite(a)}function M(a){return!("true"!==a)||"false"!==a&&("undefined"===a?null:L(a)?+a:a)}function N(b){if(!b||"object"!==a(b))return!1;var c=Object.getPrototypeOf(b);return null===c||c===Object.getPrototypeOf({})}function O(a){return null==a||Object.isFrozen(a)?a:(Object.freeze(a),Array.isArray(a)?a.forEach(function(a){return O(a)}):N(a)&&Object.getOwnPropertyNames(a).forEach(function(b){return O(a[b])}),a)}function P(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];return O(Object.assign.apply(Object,[Object.create(null)].concat(b)))}function Q(a){return"/"===a.charAt(0)}function R(a){var b=new URL(a,window.location.toString()),c=window.location;return c.protocol===b.protocol&&c.hostname===b.hostname&&(c.port===b.port||""===c.port&&(80==b.port||443==b.port))}function S(a){return a=a.trim(),"/"===a?a:a.replace(Y,"")}function T(a,b,c){if(N(a))for(var d in a)c(d,a[d]);else c(a,b)}function U(c,a){if(c===a)return!0;if(null===c||null===a)return!1;var b=Object.prototype.toString.call(c),d=Object.prototype.toString.call(a);if(b!=d)return!1;switch(b){case"[object Date]":case"[object Number]":return+c==+a||+c!=+c&&+a!=+a;case"[object Function]":case"[object String]":case"[object Boolean]":return""+c==""+a;case"[object Array]":if(c.length!=a.length)return!1;for(var e=0;e<c.length;e++)if(!U(c[e],a[e]))return!1;return!0;case"[object Object]":{var f=Object.keys(c),g=Object.keys(a);return f.length==g.length&&f.every(function(b){return U(c[b],a[b])})}default:return!1;}}function V(a){var b=[],c=a.split("/").map(function(a){if(!a)return a;var c=a.length,d=a.charCodeAt(0);if(42===d)return b.push("wildcard"),"/(.*)";if(58===d){var e=63===a.charCodeAt(c-1);return b.push(a.substring(1,e?c-1:c)),e?"(?:/([^/]+?))?":"/([^/]+?)"}return"/"+a}),d=new RegExp("^"+c.join("")+"/?$","i");return function(a){var c=d.exec(a);return c&&c[0]?c.slice(1).map(decodeURI).map(M).reduce(function(a,c,d){return a[b[d]]=c,a},{}):null}}var W,X=function(b,c,d,f){var e;c[0]=0;for(var g=1;g<c.length;g++){var i=c[g++],j=c[g]?(c[0]|=i?1:2,d[c[g++]]):c[++g];3===i?f[0]=j:4===i?f[1]=Object.assign(f[1]||{},j):5===i?(f[1]=f[1]||{})[c[++g]]=j:6===i?f[1][c[++g]]+=j+"":i?(e=b.apply(j,X(b,j,d,["",null])),f.push(e),j[0]?c[0]|=2:(c[g-2]=0,c[g]=e)):f.push(j)}return f},n=new Map,t=[],Y=/\/$/,Z=/*#__PURE__*/function(){function c(){var a=this,d=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};b(this,c),"title"in d?document.title=d.title:d.title=document.title,this._state=P(d),this._mutations=Object.create(null),this._actions=new Map,this._events=new Map,this._dispatchers=new Map,this._views=[],this._commit=this.commit.bind(this),this._dispatch=this.dispatch.bind(this),this._redirect=this.redirect.bind(this),this._navigate=this.navigate.bind(this),this._emit=this.emit.bind(this);var e=this._handleEvent.bind(this);document.documentElement.addEventListener("click",e,!1),document.documentElement.addEventListener("submit",e,!1),this.html=k.bind(function(b,c){c=c||{};for(var d=arguments.length,e=Array(2<d?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return"function"==typeof b?(c.children=e,b(a.html,c,a._getEventDispatcher())):J.apply(void 0,[b,c].concat(e))}),this.on("mutation",function(b,c,d){c.title!==d.title&&(document.title=c.title),a._views.forEach(function(a){return a()})})}return d(c,[{key:"use",value:function(a){return a(this,this.state())}},{key:"state",value:function(){return this._state}},{key:"path",value:function(){return S(window.location.pathname)}},{key:"on",value:function(a,b){var c=this,d=this._events.get(a);return void 0===d&&(d=new Set,this._events.set(a,d)),d.add(b),function(){return c._events.get(a)["delete"](b)}}},{key:"emit",value:function(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=this._events.get(a);void 0!==e&&0<e.size&&e.forEach(function(a){return a.apply(void 0,c)})}},{key:"mutation",value:function(a,b){var c=this;T(a,b,function(a,b){c._mutations[a]=b})}},{key:"commit",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,c=this._mutations[a];if(c){var d=this.state(),e=c(d,b);return this._state=P(d,e),this.emit("mutation",a,this._state,d,e),e}return null}},{key:"action",value:function(a,b){var c=this;T(a,b,function(a,b){c._actions.set(a,b)})}},{key:"route",value:function(a,b){var c=this;this._onPopState||(this._onPopState=this._handlePopState.bind(this),window.addEventListener("popstate",this._onPopState,!1)),T(a,b,function(a,b){c._actions.set(V(a),b)})}},{key:"dispatch",value:function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.path(),c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,a=this._getDispatcher(b,c);return a?a():null}},{key:"navigate",value:function(a){return this._modifyHistory(a,"navigate")}},{key:"redirect",value:function(a){return this._modifyHistory(a,"redirect")}},{key:"view",value:function(a,b){var c=this;"string"==typeof a&&(a=document.querySelector(a));var d,e=function(){return d?d:d=K(function(){var e=b(c.html,c.state(),c._getEventDispatcher()),f=h(a,e);d=null,c.emit("render",f)})};this._views.push(e),e()}},{key:"_modifyHistory",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"navigate";if(a=S(a),a!==this.path()){var c=this._getDispatcher(a);return c?(history["redirect"===b?"replaceState":"pushState"](null,"",a),this.emit("pathchange",a),c()):null}}},{key:"_getDispatcher",value:function(b){var c=this,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,f=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,g=!0,h=!1,i=void 0;try{for(var j,k,l=function(){var a=e(j.value,2),g=a[0],h=a[1],i=void 0;if(Q(b)&&"string"!=typeof g){var k=S(b);d=g(k),d&&(i="route",0===Object.keys(d).length&&(d=null))}else g===b&&(i="action");return i?{v:function(){var a={params:d,event:f,state:c.state(),commit:c._commit,dispatch:c._dispatch,navigate:c._navigate,redirect:c._redirect,emit:c._emit};"route"===i&&(a.path=b);var e=2>h.length?h(a):new Promise(function(b,c){return h(a,b,c)});return c.emit("dispatch",i,b,c.state(),d,f,e),e}}:void 0},m=this._actions[Symbol.iterator]();!(g=(j=m.next()).done);g=!0)if(k=l(),"object"===a(k))return k.v}catch(a){h=!0,i=a}finally{try{g||null==m["return"]||m["return"]()}finally{if(h)throw i}}return null}},{key:"_getEventDispatcher",value:function(){var a=this;return function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:null,d=!0,f=!1,g=void 0;try{for(var h,i=a._dispatchers[Symbol.iterator]();!(d=(h=i.next()).done);d=!0){var j=e(h.value,2),k=j[0],l=j[1];if(k[0]===b&&U(c,k[1]))return l}}catch(a){f=!0,g=a}finally{try{d||null==i["return"]||i["return"]()}finally{if(f)throw g}}var m=function(d){var e=a._getDispatcher(b,c,d instanceof Event?d:null);return e?e():null};return a._dispatchers.set([b,c],m),m}}},{key:"_handlePopState",value:function(){var a=this.path();this.dispatch(a),this.emit("pathchange",a)}},{key:"_handleEvent",value:function(b){if(!b.defaultPrevented){var c;if("submit"===b.type)c=b.target.getAttribute("action");else{if(b.button||b.ctrlKey||b.metaKey||b.altKey||b.shiftKey)return;var d=b.target.closest("a");if(!d)return;var e="object"===a(d.href)&&"SVGAnimatedString"===d.href.constructor.name;if("_blank"===d.getAttribute("target"))return;if("external"===d.getAttribute("rel"))return;if(d.hasAttribute("download"))return;if(!e&&!R(d))return;if(c=e?d.href.baseVal:d.getAttribute("href"),-1<c.indexOf("mailto:"))return}if(c){var f=Q(c);if(f&&(c=S(c)),!(f&&c===this.path())){var g=this._getDispatcher(c,null,b);g&&(b.preventDefault(),f&&(history.pushState(null,"",c),this.emit("pathchange",c)),g())}}}}}]),c}();return function(a){return new Z(a)}});
